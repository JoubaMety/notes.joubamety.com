{"/":{"title":"JoubaMety's Notes","content":"There will be notes here... one day!\n\n","lastmodified":"2023-04-14T21:12:25.290954957Z","tags":[]},"/ffmpeg/Create-a-video-with-static-album-art-and-album-track":{"title":"Create a video with static album art and album track","content":"Sometimes, I like to share music to my Discord friends. **Unfortunately, Discord doesn't yet have native audio player in mobile apps.**\nSo in order for my iOS/Android friends to still be able to play music without having to download them, I've started using ffmpeg to create videos with album art and music track VERY quickly, without the need of some kind of video editor, just one *(or multiple, depending on complexity of problem.)*\n\n# 0. Get album art if not available.\nYou might not have album art, but you might have music file with album art inside. If so, then there's very easy way to extract it.\n```bash\nffmpeg -i music.mp3 cover.jpg\n```\n# 1. The magic command\n```bash\nffmpeg -loop 1 -i cover.jpg -i music.mp3 -map 0:v:0 -map 1:a:0 -pix_fmt yuv420p -vf scale=1080:-2:flags=lanczos -c:v libx264 -tune stillimage -c:a aac -b:a 128k -shortest -movflags +faststart epic.mp4\n```\nI'm gonna point out few important things that make this command work.\n- `-loop 1` loops the image, because otherwise image will show for maybe one second and then the rest of video is broken because of that.\n- `-vf scale=1080:-2:flags=lanczos` scales the video to width of 1080 and then fitting height while still being divisible by 2.\n  This is important because of two things: efficiency and libx264.\n  - Efficiency is because we prolly won't need 2160x2160, which is more taxing to decode, but also to encode.\n  - Libx264 doesn't like height/width that isn't divisible by 2. So that's also an extra measure.\n- `-shortest` shorts the loop. Well, basically, since the first input `cover.jpg` is being looped constantly thanks to the first flag, we **need** to stop encoding once audio is done, because if we don't do this, it will continue encoding indefinitely until we fill our disk space with cover art.\n\n# The *very hopeful* result\n\n**New Order - Blue Monday**\n\u003cdiv style=\"max-width: 512px;\"\u003e\u003c/div\u003e\n![[ffmpeg/_media/New Order - Blue Monday.webm]]\n[FFMPEG command](_media/New Order - Blue Monday.webm-ffmpeg.txt)","lastmodified":"2023-04-14T21:12:25.290954957Z","tags":["ffmpeg","static image"]}}