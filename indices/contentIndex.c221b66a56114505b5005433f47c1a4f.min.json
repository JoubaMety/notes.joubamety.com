{"/":{"title":"JoubaMety's Notes","content":"This is the place where I, **JoubaMety**, store my public notes, code snippets and such.\n\nWhat inspired me to start this was that I was often finding myself scrolling through console history or browser history, searching for how to use specific video filter in `ffmpeg`.\u003cbr\u003e\nI also help some people with `ffmpeg`, so having a place which I can just link to other people, with better info rather than remembering from head, which can be sometimes treacherous or even dangerous.\u003cbr\u003e\n\nHere are the main tags, where you can find notes under:\n- [[tags/video|Video]] - Here, you can find stuff related to creating or transcoding videos","lastmodified":"2023-04-16T10:56:03.328507368Z","tags":[]},"/video/ffmpeg/installation":{"title":"FFMPEG Installation","content":"# What's FFMPEG?\n# Install FFMPEG on Windows\n* Pre-compiled binaries\n\t* Go to [`gyan.dev/ffmpeg/builds`](https://www.gyan.dev/ffmpeg/builds/)","lastmodified":"2023-04-16T10:56:03.332507416Z","tags":["ffmpeg","installation","windows","linux"]},"/video/ffmpeg/video_with_static_background_image_and_audio":{"title":"Create a video with static background image and audio","content":"Sometimes, I like to share music to my Discord friends. **Unfortunately, Discord doesn't yet have native audio player in mobile apps. *(Except voice messages?! What's up with that, Discord?)***\u003cbr\u003e\nSo in order for my iOS/Android friends to still be able to play music without having to download them, I've started using [`ffmpeg`](video/ffmpeg/installation) to create videos with album art and music track VERY quickly, without the need of some kind of video editor, just one *(or multiple, depending on complexity of problem.)*\n\n# 0. Get album art if not available.\nYou might not have album art, but you might have music file with album art inside. If so, then there's very easy way to extract it.\n```bash\nffmpeg -i music.mp3 cover.jpg\n```\n# 1. The magic command\nWe're gonna basically input two media files: album art and music, use `libx264` with `-tune -stillimage` for best possible compression and `aac` because Apple s\\*\\*ks a\\*\\*, and then output to mp4\n```bash\nffmpeg -loop 1 -i cover.jpg -i music.mp3 -map 0:v:0 -map 1:a:0 -pix_fmt yuv420p -vf scale=1080:-2:flags=lanczos -c:v libx264 -tune stillimage -c:a aac -b:a 128k -shortest -movflags +faststart epic.mp4\n```\nI'm gonna point out few important things that make this command work.\n- `-loop 1` loops the image, because otherwise image will show for maybe one second and then the rest of video is broken because of that.\n- `-pix_fmt yuv420p` sets the pixel format to YUV420p, so we don't get unexpected behavior when converting from PNG's RGB24 or JPG's YUV444.\n- `-vf scale=1080:-2:flags=lanczos` scales the video to width of 1080 and then fitting height while still being divisible by 2.\n  This is important because of two things: efficiency and libx264.\n  - Efficiency is because we prolly won't need 2160x2160, which is more taxing to decode, but also to encode.\n  - Libx264 doesn't like height/width that isn't divisible by 2. So that's also an extra measure.\n- `-shortest` shorts the loop. Well, basically, since the first input `cover.jpg` is being looped constantly thanks to the first flag, we **need** to stop encoding once audio is done, because if we don't do this, it will continue encoding indefinitely until we fill our disk space with cover art.\n\n# The *very hopeful* result\n\u003cvideo id=\"myvideo\" controls width=\"256\"\u003e\n\t\u003csource src=\"/video/ffmpeg/_media/New Order - Blue Monday.webm\" type=\"video/webm\"\u003e\n\tHuh\n\u003c/video\u003e\n\u003cscript\u003e\nvar video = document.getElementById(\"myvideo\");\nvideo.setAttribute(\"controls\",\"controls\")   \n\u003c/script\u003e\n\n- **New Order - Blue Monday**\n```bash\nffmpeg -y -loop 1 -i .\\cover.JPG -ss 01:30 -to 01:40 -i '.\\01 - Blue Monday.flac' -map 0:v -map 1:a -pix_fmt yuv420p -vf scale=256:-2:flags=lanczos -c:v libsvtav1 -preset 6 -c:a libopus -b:a 80k -shortest -movflags +faststart '.\\New Order - Blue Monday.webm'\n```","lastmodified":"2023-04-16T10:56:03.332507416Z","tags":["video","ffmpeg","static background"]}}